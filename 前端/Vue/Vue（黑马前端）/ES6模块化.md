# Node.js如何实现模块化

node.js 遵循了 CommonJS 的模块化规范。其中：

- 导入其它模块使用 `require()` 方法  
- 模块对外共享成员使用 `module.exports 对象`  



# 前端模块化规范的分类

- 在 ES6 模块化规范诞生之前，JavaScript 社区已经尝试并提出了 **AMD**、CMD、**CommonJS** 等模块化规范
- 但是，这些由社区提出的模块化标准，还是存在一定的差异性与局限性、并不是浏览器与服务器通用的模块化标准，例如：  
  - AMD 和 CMD 适用于浏览器端的  Javascript 模块化  
  - CommonJS 适用于服务器端的 Javascript 模块化  

太多的模块化规范给开发者增加了学习的难度与开发的成本。因此，大一统的 ES6 模块化规范诞生  



# 什么是 ES6 模块化规范  

- ES6 模块化规范是**浏览器端与服务器端通用**的模块化开发规范。
- 它的出现极大的降低了前端开发者的模块化学习成本，开发者不需再额外学习 AMD、CMD 或 CommonJS 等模块化规范。  



ES6 模块化规范中定义：

- 每个 js 文件都是一个独立的模块
- 导入其它模块成员使用 `import` 关键字
- 向外共享模块成员使用 `export` 关键字



# ES6 模块化的基本语法

ES6 的模块化主要包含如下 3 种用法：  

- **默认导出** 与 **默认导入**
- **按需导出** 与 **按需导入**
- 直接导入并执行模块中的代码  



## 默认导出与导入

### 默认导出

默认导出的语法： `export default 默认导出的成员`  

```js
let n1 = 10;	// 定义模块私有成员n1
let n2 = 20;	// 定义模块私有成员n2（但外界无法直接访问n2，因为它没被共享出去）
function show(){};	// 定义模块私有方法show

export default {
    n1,
    show
}
```



每个模块中，**只允许使用唯一的一次 export default**，否则会报错！  

![image-20220618224648978](ES6%E6%A8%A1%E5%9D%97%E5%8C%96.assets/image-20220618224648978.png)



### 默认导入

默认导入的语法： `import 接收名称 from '模块标识符'`  

```js
// 从01_m1.js模块中，导入export default向外共享的成员
// 并使用 m1 成员进行接收
import m1 from './01_m1.js'

console.log(m1);	// {n1:10,show:[Function:show]}
```



默认导入时的接收名称可以任意名称，只要是合法的成员名称即可：  

![image-20220618224708841](ES6%E6%A8%A1%E5%9D%97%E5%8C%96.assets/image-20220618224708841.png)





## 按需导出与导入

### 按需导出

按需导出的语法： `export 按需导出的成员 ` 

```js
export let s1 = 'aaa'	// 向外按需导出变量s1
export let s2 = 'ccc'	// 向外按需导出变量s2
export function say(){}	// 向外按需导出方法say
```



### 按需导入

按需导入的语法： `import { s1 } from '模块标识符'`  

```js
import {s1, s2, say} from './03_m2.js'

console.log(s1);	// aaa
console.log(s2);	// ccc
console.log(say);	// [Function:say]
```



### 注意事项

- 每个模块中，可以使用**多次按需导出**

- 按需导入的成员名称，必须和按需导出的名称保持一致

  >可以使用 as 关键字进行重命名  

- 按需导入可以和默认导入一起使用



## 直接导入并执行模块中的代码

如果只想单纯地执行某个模块中的代码，并不需要得到模块中向外共享的成员。

此时，可以直接导入并执行模块代码，示例代码如下：  

```js
// 当前文件模块为：05_m3.js
// 模拟当前模块的操作
for(let i=0; i<3; i++){
    console.log(i)
}

--------------分割线-------------
// 另一个模块：直接导入并执行模块代码
import './05_m3.js'
```

